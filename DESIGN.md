# 设计文档

## 项目概述

本项目旨在开发一个基于大模型技术和AGI技术的AI Agent，能够帮助一线人员提升工作效率，具备行业专家的相关能力。该项目还包括一个简单的知识库系统，用户可以根据需要自定义扩展。

### 目标功能

1. **长短期记忆**：能够记录和存储用户输入的数据，并根据记忆提供相关反馈。
2. **文档查询**：通过加载和处理文档，能够从中提取有用的信息。
3. **网络查询**：能够联网并使用大模型（如 Ollama模型框架）进行问题解答。
4. **知识库**：能够将用户的问答过程保存到本地知识库中，供后续查询使用。

## 系统设计

### 1. 系统架构

本系统由以下模块组成：

- **Interaction模块**：负责处理用户输入、返回答复，并管理问答的存储。
- **Memory模块**：负责长短期记忆的存储和检索。
- **Knowledge模块**：负责加载和查询本地知识库。
- **WebSearch模块**：负责联网查询并返回相关结果。

### 2. 各模块功能说明

#### 2.1 Interaction模块

该模块负责与用户的交互。主要功能包括：
- 接收用户输入，调用相应的模块进行处理。
- 首先在本地知识库中查询相关信息，如果没有找到，则调用 WebSearch 模块进行网络查询。
- 保存用户提问和系统回答到知识库中，方便后续查询。

**设计思路**：
- 通过与 Memory 模块和 Knowledge 模块协作，记录用户的提问和系统的回答。
- 使用 WebSearch 模块进行联网查询，解决本地知识库没有的问答。

#### 2.2 Memory模块

该模块负责长短期记忆的管理。包括：
- **短期记忆**：将最近的用户输入保存在内存中，以便在短期内再次使用。
- **长期记忆**：通过关键字存储并检索长期记忆，以便长期管理和检索重要信息。

**设计思路**：
- 通过时间戳存储短期记忆，限制记忆的条目数。
- 通过关键字和对应的值存储长期记忆，实现对特定信息的长期跟踪和管理。

#### 2.3 Knowledge模块

该模块负责加载本地知识库并支持查询。其主要功能为：
- 加载并管理存储在 JSON 文件中的知识库数据。
- 提供基于关键字的查询功能，返回与查询匹配的答案。

**设计思路**：
- 使用 JSON 格式存储知识库内容，便于扩展和管理。
- 支持通过关键字查询知识库，返回相关的知识条目。

#### 2.4 WebSearch模块

该模块负责联网查询，并结合文档信息提供答案。其功能包括：
- 查询本地文档内容，返回相关答案。
- 如果本地文档中没有相关内容，则调用外部模型（如 qwen2）进行联网查询。

**设计思路**：
- 优先查询本地文档，提供较为准确的答案。
- 当本地查询无果时，利用大模型联网进行查询，提升回答准确度。

## 模块协作

各模块通过以下方式协同工作：

1. **Interaction模块** 接收到用户的输入后，首先查询 **Knowledge模块**。
2. 如果 **Knowledge模块** 中没有找到相关答案，则调用 **WebSearch模块** 进行联网查询。
3. 在获取答案后， **Interaction模块** 将用户的提问和系统的回答保存到本地知识库，更新 **Knowledge模块**。
4. **Memory模块** 用于存储和检索短期和长期记忆，用于提供个性化的回答。

## 数据存储与管理

- **知识库**：通过 `knowledge.json` 文件存储知识数据，采用 JSON 格式管理，用户可以在此文件中添加新的知识条目。
- **记忆**：短期记忆和长期记忆分别存储在内存中，短期记忆会根据时间和数量进行清理。